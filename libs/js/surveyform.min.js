!function(){const e=document.currentScript;let t;try{t=new URL(e.src).origin}catch(e){return void console.error("Can't parse url",e)}"undefined"==typeof SurveyForm&&(SurveyForm={}),SurveyForm.getAlias=function(e){return e=(e=(e=e.replace(".mysapo.net","")).replace("http://","")).replace("https://","")},SurveyForm.parseHtml=function(e){return(new DOMParser).parseFromString(e,"text/html").body.childNodes[0]},SurveyForm.serializeForm=function(e){const t={};if("object"==typeof e&&"form"===e.nodeName.toLowerCase()){const a=e.querySelectorAll("input, select");for(let e=0;e<a.length;e++)a[e].getAttribute("name")&&(t[a[e].getAttribute("name")]=a[e].value)}return t},SurveyForm.removeAccents=function(e){const t=["aàảãáạăằẳẵắặâầẩẫấậ","AÀẢÃÁẠĂẰẲẴẮẶÂẦẨẪẤẬ","dđ","DĐ","eèẻẽéẹêềểễếệ","EÈẺẼÉẸÊỀỂỄẾỆ","iìỉĩíị","IÌỈĨÍỊ","oòỏõóọôồổỗốộơờởỡớợ","OÒỎÕÓỌÔỒỔỖỐỘƠỜỞỠỚỢ","uùủũúụưừửữứự","UÙỦŨÚỤƯỪỬỮỨỰ","yỳỷỹýỵ","YỲỶỸÝỴ"];for(let a=0;a<t.length;a++){const r=new RegExp("["+t[a].substr(1)+"]","g"),n=t[a][0];e=e.replace(r,n)}return e},SurveyForm.convertToIdOrName=function(e){return e?this.removeAccents(e.replace(/[-_()[\]{}]/g," ").replace(/(?:^|\s|["'([{])+\S/g,(function(e){return e.toUpperCase()})).replace(/[ \r\t\n]/g,"")):""},SurveyForm.clone=function(e){return e.cloneNode(!0)},SurveyForm.RunTracking=function(e){const t=window.document,a=t.createElement("script");a.text=e,t.head.appendChild(a).parentNode.removeChild(a)},SurveyForm.hostApi=t+"/api/storefront",SurveyForm.hostLibs=t+"/libs",SurveyForm.store=Bizweb.store,SurveyForm.styleInline="",SurveyForm.icons={refresh:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.005 4C14.2151 4 16.2128 4.89397 17.6585 6.34L20 4V11H12.9956L16.2176 7.78C15.1379 6.6909 13.6585 6.00114 11.9991 6C9.39003 6.00251 7.17137 7.67175 6.35147 10H6.33378C6.21976 10.3217 6.13245 10.6559 6.07452 11H4.0617C4.55243 7.05239 7.91112 4 11.995 4H12.005Z" /><path d="M4 13V20L6.34146 17.66C7.78717 19.106 9.78489 20 11.995 20L12.005 20C16.0889 20 19.4476 16.9476 19.9383 13H17.9255C17.8676 13.3441 17.7802 13.6783 17.6662 14H17.6485C16.8287 16.3282 14.6101 17.9974 12.0012 18C10.3417 17.9989 8.86221 17.3092 7.78236 16.22L11.0044 13H4Z" /></svg>',selectCaret:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" name="SelectCaret" width="20" height="20"><path d="m12 19-4.7-4.7h9.3L12 19zm0-14L7.3 9.7h9.3L12 5z"></path></svg>',clock:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" name="Clock"><path d="M12 3c-5 0-9 4-9 9s4 9 9 9 9-4 9-9-4-9-9-9zm0 16.2c-4 0-7.2-3.2-7.2-7.2S8 4.8 12 4.8 19.2 8 19.2 12 16 19.2 12 19.2z"></path><path d="M12.9 7.5h-1.8v5.4h5.4v-1.8h-3.6V7.5z"></path></svg>',calendar:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" name="Calendar"><path d="M18.6,21.4H5.4c-1,0-1.9-0.8-1.9-1.9V6.3c0-1,0.8-1.9,1.9-1.9h1.9V2.6h1.9v1.9h5.7V2.6h1.9v1.9h1.9c1,0,1.9,0.8,1.9,1.9 v13.2C20.5,20.6,19.6,21.4,18.6,21.4z M5.4,10.1v9.4h13.2v-9.4H5.4z M5.4,6.3v1.9h13.2V6.3H5.4z M16.7,17.7h-1.9v-1.9h1.9V17.7z M12.9,17.7h-1.9v-1.9h1.9V17.7z M9.2,17.7H7.3v-1.9h1.9V17.7z M16.7,13.9h-1.9V12h1.9V13.9z M12.9,13.9h-1.9V12h1.9V13.9z M9.2,13.9H7.3V12h1.9V13.9z" /></svg>',colorPicker:'<svg width="22" height="23" viewBox="0 0 22 23" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.9531 15.4723L11.3828 17.3008L10.9531 18.9612C9.95328 18.9612 8.74148 19.1942 7.87007 18.8374C6.94581 18.459 6.37218 17.4707 5.67725 16.7758L6.53662 15.0573L8.14473 14.3088C8.86312 15.0277 9.8563 15.4723 10.9531 15.4723Z" fill="#EE61EB" /><path d="M8.14477 14.3084V14.3089L5.67729 16.7759C5.00226 16.1008 4.02626 15.34 3.6487 14.4474C3.27109 13.5547 3.4919 12.5302 3.4919 11.5L5.34265 11.0703L6.98131 11.5C6.98135 12.5963 7.42591 13.5895 8.14477 14.3084Z" fill="#0065A3" /><path d="M8.14478 8.69156C7.42591 9.41043 6.98132 10.4036 6.98132 11.5H3.49191C3.49191 10.5712 3.18898 9.38134 3.49908 8.56115C3. 87691 7.56182 4.93579 6.96563 5.6773 6.22412L7.50562 7.19311L8.14478 8.69156Z" fill="#99EEFF" /><path d="M10.9532 4.03883L11.3829 5.78521L10.9532 7.52777C9.85591 7.52777 8.86316 7.97279 8.14473 8.69166L5.67725 6.22418C6.35229 5.54914 6.7265 4.57311 7.61918 4.1955C8.51185 3.81793 9.92299 4.03883 10.9532 4.03883Z" fill="#93E300" /><path d="M16.229 6.224L15.365 7.94735L13.762 8.69101C13.0431 7.97214 12.0499 7.52754 10.9531 7.52754V4.03861C11.9468 4.03861 13.3248 3.80323 14.1918 4.15587C15.1224 4.53438 15.5298 5.52503 16.229 6.224Z" fill="#FFF375" /><path d="M18.4146 11.5L16.6574 11.9297L14.9252 11.5C14.9252 10.4032 14.4806 9.41 13.7617 8.69113L16.2287 6.22412H16.2292C16.9282 6.92309 17.9188 7.33048 18.2973 8.26118C18.65 9.12825 18.4146 10.5063 18.4146 11.5Z" fill="#FFC34D" /><path d="M18.4146 11.5C18.4146 12.4937 18.9508 13.7428 18.5982 14.6098C18.2196 15.5407 16.928 16.0771 16.2287 16.7759L14.6001 16.0066L13.7617 14.3089C14.4806 13.59 14.9252 12.5968 14.9252 11.5H18.4146V11.5Z" fill="#FF3377" /><path d="M16.229 16.7759C15.5537 17.451 14.8788 18.427 13.9862 18.8046C13.0936 19.1821 11.9833 18.9613 10.9531 18.9613V15.4723C12.0499 15.4723 13.0431 15.0277 13.762 14.3088L16.229 16.7759Z" fill="#FF5CA8" /><path d="M10.953 18.9613L11.3827 20.7955L10.953 22.4995C7.9219 22.4872 5.18054 21.2489 3.19873 19.2543L4.0013 17.5924L5.67717 16.7759C7.02729 18.126 8.89269 18.9613 10.953 18.9613Z" fill="#C331C8" /><path d="M18.7544 19.3013C16.7658 21.2781 14.0258 22.5 11.0001 22.5C10.9846 22.5 10.9686 22.5 10.9531 22.4995V18.9613C13.0135 18.9613 14.8784 18.126 16.229 16.7759L18.0521 17.7396L18.7544 19.3013Z" fill="#FF3377" /><path d="M22.0001 11.5C22.0001 14.5494 20.7591 17.3095 18.7544 19.3013L16.229 16.7759C17.5796 15.4262 18.4149 13.5608 18.4149 11.5L20.2384 11.0703L22.0001 11.5Z" fill="#E50048" /><path d="M22.0002 11.5001H18.4149C18.4149 9.4397 17.5796 7.5743 16.2295 6.22418L17.0783 4.51574L18.7545 3.69873C20.7591 5.69059 22.0002 8.45064 22.0002 11.5001Z" fill="#FF9933" /><path d="M18.7544 3.69868L16.2295 6.22412H16.229C14.8784 4.874 13.0134 4.03873 10.9531 4.03873L10.5234 2.43364L10.9531 0.500473C10.9686 0.5 10.9846 0.5 11.0001 0.5C14.0258 0.5 16.7658 1.72186 18.7544 3.69868Z" fill="#FFDE46" /><path d="M10.953 0.500488V4.03875C8.89273 4.03875 7.02729 4.87402 5.67717 6.22414L4.03005 5.4364L3.19873 3.7457C5.18054 1.75109 7.9219 0.512777 10.953 0.500488Z" fill="#00DA26" /><path d="M5.67712 6.22404C4.32695 7.57416 3.49168 9.43957 3.49168 11.4999L1.6185 11.9296L0 11.4999C0 8.47423 1.22186 5.73429 3.19868 3.74561L5.67712 6.22404Z" fill="#33DDFF" /><path d="M5.67712 16.7759L3.19868 19.2543C1.22186 17.2656 0 14.5257 0 11.5H3.49168C3.49168 13.5604 4.32695 15.4258 5.67712 16.7759Z" fill="#194D80" /></svg>',checked:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 12.56" name="Checked" class="icon-check"><path d="m5.33 8.79 8.79-8.8L16 1.89 5.33 12.56 0 7.23l1.88-1.88Z"></path></svg>',loading:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" class="icon-loading"><circle cx="84" cy="50" r="10"><animate attributeName="r" repeatCount="indefinite" dur="0.25s" calcMode="spline" keyTimes="0;1" values="10;0" keySplines="0 0.5 0.5 1" begin="0s"></animate><animate attributeName="fill" repeatCount="indefinite" dur="1s" calcMode="discrete" keyTimes="0;0.25;0.5;0.75;1" begin="0s"></animate></circle><circle cx="16" cy="50" r="10"><animate attributeName="r" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="0;0;10;10;10" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="0s"></animate><animate attributeName="cx" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="16;16;16;50;84" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="0s"></animate></circle><circle cx="50" cy="50" r="10"><animate attributeName="r" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="0;0;10;10;10" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.25s"></animate><animate attributeName="cx" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="16;16;16;50;84" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.25s"></animate></circle><circle cx="84" cy="50" r="10"><animate attributeName="r" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="0;0;10;10;10" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.5s"></animate><animate attributeName="cx" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="16;16;16;50;84" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.5s"></animate></circle><circle cx="16" cy="50" r="10"><animate attributeName="r" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="0;0;10;10;10" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.75s"></animate><animate attributeName="cx" repeatCount="indefinite" dur="1s" calcMode="spline" keyTimes="0;0.25;0.5;0.75;1" values="16;16;16;50;84" keySplines="0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1" begin="-0.75s"></animate></circle></svg>',checkedCircle:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" name="CheckedCircle"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zm-2-5.8 6.6-6.6L18 9l-8 8-4-4 1.4-1.4 2.6 2.6z"></path></svg>',timesCircle:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 24 24"><path d="M12,4c-4.4,0-8,3.6-8,8c0,4.4,3.6,8,8,8c4.4,0,8-3.6,8-8C20,7.6,16.4,4,12,4z M2,12C2,6.5,6.5,2,12,2c5.5,0,10,4.5,10,10 c0,5.5-4.5,10-10,10C6.5,22,2,17.5,2,12z M7.8,7.8c0.4-0.4,1-0.4,1.4,0l2.8,2.8l2.8-2.8c0.4-0.4,1-0.4,1.4,0c0.4,0.4,0.4,1,0,1.4 L13.4,12l2.8,2.8c0.4,0.4,0.4,1,0,1.4c-0.4,0.4-1,0.4-1.4,0L12,13.4l-2.8,2.8c-0.4,0.4-1,0.4-1.4,0c-0.4-0.4-0.4-1,0-1.4l2.8-2.8 L7.8,9.2C7.4,8.8,7.4,8.2,7.8,7.8z" /></svg>'},SurveyForm.dataTypeList={textbox:1,number:2,radio:3,checkbox:4,select:5,country:6,date:7,clock:8,color:9,textarea:10,email:11,phone:12,file:13,name:14,captcha:99},SurveyForm.dataTypeMappingField={1:"text",2:"text",3:"list",4:"list",5:"list",6:"list",7:"text",8:"text",9:"text",10:"text",11:"text",12:"text",13:"text",14:"text",99:"captcha"},SurveyForm.formIds=[],SurveyForm.formConfigs=[],SurveyForm.regions=[],SurveyForm.htmlWrapper={formGroup:'<div class="form-group"></div>',hasError:'<div class="has-error"></div>'},SurveyForm.getFormIds=function(){const e=this,t=document.querySelectorAll('[data-app="bizweb_form"]');if(t.length>0)for(const a of t)e.formIds.push(a.getAttribute("data-form-id"))},SurveyForm.getFormConfigs=async function(){const e=this;await fetch(`${e.hostApi}?storeAlias=${e.getAlias(e.store)}&ids=${e.formIds.toString()}`,{credentials:"include"}).then((function(e){return e.json()})).then((function(t){200===t.code&&t.result&&(e.formConfigs=t.result,e.JSESSIONID=t.jsessionid)})).catch((function(e){console.log("Có lỗi xảy ra. Vui lòng thử lại sau")}))},SurveyForm.getRegions=async function(){const e=this;await fetch(`${e.hostApi}/regions`,{credentials:"include"}).then((function(e){return e.json()})).then((function(t){200===t.code&&t.result&&(e.regions=t.result.map((function(e){return e.name})))})).catch((function(e){console.log("Có lỗi xảy ra. Vui lòng thử lại sau")}))},SurveyForm.refreshCaptcha=function(e,t){e&&t&&fetch(`${this.hostApi}/${t}/captcha`,{credentials:"include"}).then((function(e){return e.json()})).then((function(t){if(200===t.code&&t.result){e.parentNode.querySelectorAll("img")[0].src=t.result.captcha}})).catch((function(e){console.log("Có lỗi xảy ra. Vui lòng thử lại sau")}))},SurveyForm.builderInput=function(e){const t=this,{indexForm:a,indexFormData:r,formId:n,language:i,formDataId:o,hasLabel:s,required:c,name:l,dataType:d,captcha:p,icon:u,regex:m,min:h,max:f}=e,y=t.parseHtml(`<div class="${d===t.dataTypeList.textarea?"base-textarea":"base-input"}${s?" has-label":""}${u?" has-icon":""}"></div>`),g=t.parseHtml(`<div class="${d===t.dataTypeList.textarea?"base-input__wrapper base-textarea__wrapper":d===t.dataTypeList.clock?"base-input__wrapper base-clockpicker__wrapper":d===t.dataTypeList.date?"base-input__wrapper base-datepicker__wrapper":d===t.dataTypeList.color?"base-input__wrapper base-colorpicker__wrapper":d===t.dataTypeList.captcha?"base-input__wrapper base-captcha__wrapper":"base-input__wrapper"}"></div>`),v=t.parseHtml(`<label for="${d===t.dataTypeList.captcha?"captcha":`${t.convertToIdOrName(l)}-${a}`}">${s?`${l}${c?'<span class="required">*</span>':""}`:""}</label>`),b=t.parseHtml(`<div class="input-hidden"><input type="hidden" name="data[${r}].id" value="${o}" /><input type="hidden" name="data[${r}].name" value="${l}" /></div>`),$=t.parseHtml(`<input ${c?"required":""} type="${d===t.dataTypeList.number?"number":d===t.dataTypeList.email?"email":d===t.dataTypeList.file?"file":"text"}" name="${d===t.dataTypeList.captcha?"captcha":d===t.dataTypeList.file?"file":`data[${r}].value`}" id="${d===t.dataTypeList.captcha?`captcha-${a}`:`${t.convertToIdOrName(l)}-${a}`}"${d===t.dataTypeList.captcha?' maxlength="4"':d===t.dataTypeList.color?' maxlength="7"':d===t.dataTypeList.number?` min="${h??1}" max="${f??9999999999}" `:' maxlength="255"'}${d===t.dataTypeList.file?' accept=".jpg,.jpeg,.gif,.png,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.pdf,.mp4,.avi,.mov,.mpeg"':""}${m?` pattern="${m}"`:""} autocomplete="off" placeholder="${s?`${i&&"english"===i?"Enter":"Nhập"} ${l.toLowerCase()}`:l}${c?"*":""}" />`),L=t.parseHtml(`<textarea autocomplete="off" maxlength="2000" name="data[${r}].value" placeholder="${s?`${i&&"english"===i?"Enter":"Nhập"} ${l.toLowerCase()}`:l}${c?"*":""}"></textarea>`),x=t.parseHtml(`<div class="captcha"><img src="${p}" alt="${l}" /><button type="button" class="base-button" onClick="SurveyForm.refreshCaptcha(this, ${n})">${this.icons.refresh}</button></div>`);d===t.dataTypeList.captcha?g.append($,x):d===t.dataTypeList.textarea?g.append(L):g.append($),u&&g.append(t.parseHtml(u)),d!==t.dataTypeList.captcha&&y.append(b),s&&y.append(v),y.append(g,t.parseHtml(t.htmlWrapper.hasError));const C=t.clone(t.parseHtml(t.htmlWrapper.formGroup));return C.classList.add(`form-group-${n}-${t.convertToIdOrName(l)}`),d===t.dataTypeList.captcha&&C.classList.add(`form-group-${n}-captcha`),C.append(y),C},SurveyForm.builderList=function(e){const t=this,{indexForm:a,indexFormData:r,formId:n,language:i,formDataId:o,hasLabel:s,required:c,name:l,dataType:d,pickValue:p,displayType:u}=e;let m=t.parseHtml(`<div class="base-select ${s?" has-label":""}${u?` ${u}`:""}"></div>`),h=t.parseHtml(`<div class="input-hidden"><input type="hidden" name="data[${r}].id" value="${o}" /><input type="hidden" name="data[${r}].name" value="${l}" /></div>`);switch(m.append(h),d){case t.dataTypeList.select:case t.dataTypeList.country:const e=t.parseHtml('<div class="base-select__wrapper"></div>'),n=t.parseHtml(`<label for="${t.convertToIdOrName(l)}-${a}">${s?`${l}${c?'<span class="required">*</span>':""}`:""}</label>`),o=t.parseHtml(`<select ${c?"required":""} class="place-holder" name="data[${r}].value" id="${t.convertToIdOrName(l)}-${a}"></select>`),f=t.parseHtml(`<option value="" ${c?"hidden":""}>${s?`${i&&"english"===i?"Select":"Chọn"} ${l.toLowerCase()}`:l}${c?"*":""}</option>`);o.append(f),(d===t.dataTypeList.country?t.regions:p).map((function(e){o.append(t.parseHtml(`<option value="${e}">${e}</option>`))})),o.addEventListener("change",(function(e){e.target.value?e.target.classList.remove("place-holder"):e.target.classList.add("place-holder")})),e.append(o),s&&m.append(n),m.append(e);break;case t.dataTypeList.radio:case t.dataTypeList.checkbox:m=t.parseHtml(`<div class="${d===t.dataTypeList.checkbox?"checkbox-list":"radio-list"}${u?` ${u}`:""}">`),m.append(h);const y=t.parseHtml(`<span class="${d===t.dataTypeList.checkbox?"checkbox-list":"radio-list"}__title">${l}${c?'<span class="required">*</span>':""}</span>`),g=t.clone(t.parseHtml(t.htmlWrapper.formGroup));if(p.map((function(e){d===t.dataTypeList.radio?g.append(t.parseHtml(`<div class="base-radio"><label><input type="radio" name="data[${r}].value" value="${e}"><span class="checkmark"></span>${e}</label></div>`)):g.append(t.parseHtml(`<div class="base-checkbox"><label><input type="checkbox" name="checkbox-${r}-${a}" value="${e}"><span class="checkmark">${t.icons.checked}</span>${e}</label></div>`))})),d===t.dataTypeList.radio){const e=g.querySelectorAll("label");c||e.forEach((function(e){const t=e.querySelectorAll("input")[0];e.addEventListener("mouseup",(function(e){t.checked&&setTimeout((function(){t.checked=!1}),0)}))})),m.append(y,g)}else{const e=t.parseHtml(`<input type="hidden" class="input-checkbox" name="data[${r}].value" />`),a=g.querySelectorAll("input");a.forEach((function(t){t.addEventListener("change",(function(t){const r=Array.prototype.slice.call(a).filter((function(e){return e.checked}));e.value=r.map((function(e){return e.value})).toString()}))})),m.append(e),m.append(y,g)}}m.append(t.parseHtml(t.htmlWrapper.hasError));const f=t.clone(t.parseHtml(t.htmlWrapper.formGroup));return f.classList.add(`form-group-${n}-${t.convertToIdOrName(l)}`),f.append(m),f},SurveyForm.renderFormData=function(e,t,a,r,n,i){const o=this,s={indexForm:t,indexFormData:a,formId:r,language:e,formDataId:i.id,hasLabel:!n||[o.dataTypeList.file,o.dataTypeList.captcha,o.dataTypeList.checkbox,o.dataTypeList.radio].includes(i.data_type),required:i.data_value.required,name:i.data_value.name,dataType:i.data_type,icon:i.data_type===o.dataTypeList.clock?o.icons.clock:i.data_type===o.dataTypeList.date?o.icons.calendar:i.data_type===o.dataTypeList.color?o.icons.colorPicker:null,min:i.data_type===o.dataTypeList.number?i.data_value.min_value:null,max:i.data_type===o.dataTypeList.number?i.data_value.max_value:null,pickValue:i.data_value.pick_value,displayType:i.data_value.display_type};switch(o.dataTypeMappingField[i.data_type]){case"text":return o.builderInput(s);case"list":return o.builderList(s);default:return""}},SurveyForm.renderCaptcha=function(e,t){const a={indexForm:e,formId:t.id,language:t.language,hasLabel:!0,required:!0,name:t.captcha_title,dataType:this.dataTypeList.captcha,captcha:t.captcha};return this.builderInput(a)},SurveyForm.renderButtons=function(e){const t=this,a=t.parseHtml('<div class="actions"></div>'),r=t.parseHtml(`<button type="reset" class="reset">${e.reset_button_title}</button>`),n=t.parseHtml(`<button type="submit" class="submit ${e.button_class_name}">${e.send_button_title}${t.icons.loading}</button>`);return a.append(r,n),a},SurveyForm.renderStyle=function(e,t){this.styleInline=this.styleInline+`.survey-form-${t.id}-${e} { width: ${t.width_desktop}%; } @media(max-width: 767px){ .survey-form-${t.id}-${e} { width: ${t.width_mobile}%; } } .survey-form-${t.id}-${e} {${"color"===t.background_type?`background: ${t.background_color};`:`background: url(${t.background_image}) no-repeat top center;`} color: ${t.text_color}; border-color: ${t.border_color}; } .survey-form-${t.id}-${e} h3, .survey-form-${t.id}-${e} p{ text-align: ${t.name_position??"center"}; } .survey-form-${t.id}-${e} div.has-label label, .survey-form-${t.id}-${e} .radio-list__title, .survey-form-${t.id}-${e} .checkbox-list__title, .survey-form-${t.id}-${e} .base-radio label, .survey-form-${t.id}-${e} .base-checkbox label{ color: ${t.text_color}; } .survey-form-${t.id}-${e} .base-input .captcha button svg{ fill: ${t.button_background_color};color: ${t.button_background_color}; } .survey-form-${t.id}-${e} .actions{ text-align: ${t.button_position??"center"}; } .survey-form-${t.id}-${e} .actions button{ border-radius: 3px; padding: 6px 15px; border: 1px solid ${t.button_background_color}; font-size: 14px; background: #ffffff; color: ${t.text_color}; line-height: 22px; font-weight: 500; outline: none; } .survey-form-${t.id}-${e} .actions .reset{ color: ${t.button_background_color}; margin-right: 16px; } .survey-form-${t.id}-${e} .actions .submit{ background: ${t.button_background_color}; color: ${t.button_text_color}; }`+t.custom_css},SurveyForm.renderForm=function(e,t){const a=this,r=a.parseHtml(`<div class="survey-form survey-form-${t.id}-${e}"></div>`),n=a.parseHtml(`<form action="${a.hostApi}/${t.id}" method="POST" accept-charset="UTF-8" autocomplete="off" onsubmit="return SurveyForm.submitForm(event, ${t.id})"></form>`),i=a.parseHtml(`<input type="hidden" name="store" value="${a.store}" />`);n.append(i);const o=a.parseHtml(`<h3>${t.name}</h3>`),s=a.parseHtml(`<p>${t.description}</p>`);n.append(o),t.description&&n.append(s);for(const[r,i]of t.form_datas.entries())n.append(a.renderFormData(t.language,e,r,t.id,t.hidden_title,i));t.show_captcha&&t.captcha&&n.append(a.renderCaptcha(e,t)),n.append(a.renderButtons(t)),r.append(n),a.renderStyle(e,t);const c=document.querySelectorAll(`[data-app="bizweb_form"][data-form-id="${t.id}"]`);if(c.length>0)for(const e of c){e.append(r);const t=r.querySelectorAll(".base-clockpicker__wrapper");for(const e of t){e.querySelectorAll("svg[name='Clock']")[0].addEventListener("click",(function(t){e.querySelectorAll("input")[0].focus()})),new TimePicker(e.querySelectorAll("input")[0],{})}const a=r.querySelectorAll(".base-datepicker__wrapper");for(const e of a){e.querySelectorAll("svg[name='Calendar']")[0].addEventListener("click",(function(t){e.querySelectorAll("input")[0].focus()})),new TinyDatePicker(e.querySelectorAll("input")[0],{})}const n=r.querySelectorAll(".base-colorpicker__wrapper");for(const e of n)new Picker({parent:e})}},SurveyForm.notification=function(e,t){const a=this;let r=null;document.querySelectorAll(".complete-message").length>0?(r=document.querySelectorAll(".complete-message")[0],r.classList.remove("error","success"),r.classList.add(e),r.innerHTML=("error"===e?a.icons.timesCircle:a.icons.checkedCircle)+t):(r=a.parseHtml(`<div class="complete-message ${e}">${"error"===e?a.icons.timesCircle:a.icons.checkedCircle}${t}</div>`),document.body.append(r)),setTimeout((function(){r.classList.add("is-show")}),200),setTimeout((function(){r.classList.remove("is-show")}),3e3)},SurveyForm.submitForm=async function(e,t){e.preventDefault();const a=this,r=e.target.querySelectorAll("button");e.target.querySelectorAll(".invalid").forEach((function(e){e.classList.remove("invalid")})),r.forEach((function(e){e.classList.add("disabled")}));const n=a.formConfigs.find((function(e){return e.id===t}));let i=null,o=null;e.target.querySelectorAll(".captcha").length>0&&(i=e.target.querySelectorAll(".captcha")[0],o=i.querySelectorAll("button")[0]);let s=!1;e.target.querySelectorAll('[type="file"]').length>0&&e.target.querySelectorAll('[type="file"]').forEach((function(e){const t=e.parentNode.parentNode,a=t.querySelectorAll(".has-error")[0];e.files.length>0&&e.files[0].size>5242880?(a.innerText="english"===n.language?"File upload can not be larger than 5MB":"Giới hạn dung lượng file tải lên không quá 5mb",t.parentNode.classList.add("invalid"),e.focus(),s=!0):(a.innerText="",t.parentNode.classList.remove("invalid"))})),s?a.notification("error",n.language&&"english"===n.language?"An error occurred, please try again":"Có lỗi xảy ra. Vui lòng thử lại sau"):await fetch(e.target.getAttribute("action"),{method:"post",body:new FormData(e.target),credentials:"include"}).then((function(e){if(200===e.status||422===e.status)return e.json();throw a.notification("error",n.language&&"english"===n.language?"An error occurred, please try again":"Có lỗi xảy ra. Vui lòng thử lại sau"),o&&o.click(),new Error(e.statusText)})).then((function(r){if(200===r.code)n.tracking_code&&a.RunTracking(n.tracking_code),a.notification("success",n.completed_message),setTimeout((function(){location.reload()}),2800);else if(422===r.code&&r.errors){if(r.errors.forEach((function(a){const r=e.target.querySelectorAll(`.form-group-${t}-${a.field}`);if(r){r[0].querySelectorAll(".has-error")[0].innerText=a.message,r[0].classList.add("invalid")}})),e.target.querySelectorAll(".invalid")){const t=e.target.querySelectorAll(".invalid")[0].querySelectorAll("input:not([type='hidden']), textarea:not([type='hidden']), select:not([type='hidden'])")[0];t&&t.focus()}o&&o.click()}else a.notification("error",n.language&&"english"===n.language?"An error occurred, please try again":"Có lỗi xảy ra. Vui lòng thử lại sau"),o&&o.click()})),r.forEach((function(e){e.classList.remove("disabled")}))},SurveyForm.loadScript=async function(e){const t=this;return new Promise((function(a,r){const n=document.createElement("script");switch(n.setAttribute("async",""),e){case"color":n.setAttribute("src",`${t.hostLibs}/js/vanilla-picker.min.js?v=1`);break;case"date":n.setAttribute("src",`${t.hostLibs}/js/tiny-date-picker.min.js?v=1`);break;case"clock":n.setAttribute("src",`${t.hostLibs}/js/time-picker.min.js?v=1`)}n.onload=a,n.onerror=r,document.head.appendChild(n)}))},SurveyForm.loadCss=async function(){const e=this;return new Promise((function(t,a){const r=document.createElement("link");r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href",`${e.hostLibs}/css/surveyform.min.css`),r.onload=t,r.onerror=a,document.head.appendChild(r)}))},SurveyForm.loadCssInline=async function(){const e=document.createElement("style");e.setAttribute("type","text/css"),e.appendChild(document.createTextNode(this.styleInline)),document.head.appendChild(e)},SurveyForm.init=async function(){const e=this;if(e.getFormIds(),e.formIds.length>0&&await e.getFormConfigs(),e.formConfigs.length>0){await e.loadCss();let t=!1,a=!1,r=!1,n=!1;e.formConfigs.map((function(i){t||(t=i.form_datas.filter((function(t){return t.data_type===e.dataTypeList.country})).length>0),a||(a=i.form_datas.filter((function(t){return t.data_type===e.dataTypeList.date})).length>0),r||(r=i.form_datas.filter((function(t){return t.data_type===e.dataTypeList.clock})).length>0),n||(n=i.form_datas.filter((function(t){return t.data_type===e.dataTypeList.color})).length>0)})),t&&await e.getRegions(),a&&await e.loadScript("date"),r&&await e.loadScript("clock"),n&&await e.loadScript("color");for(const[t,a]of e.formConfigs.entries())e.renderForm(t,a);await e.loadCssInline()}},SurveyForm.init()}();